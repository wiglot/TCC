\chapter{Problema de Agrupamento}

Agrupamento não apenas expressa o ato de separar dados em grupos, mas separa-los de modo que os elementos dos grupos resultantes tenham algumas características comuns entre si.
 Segundo Lorena e Furtado \cite{lorena2001constructive} ``problemas de
 agrupamento geralmente aparecem em classificação de dados para algum propósito como armazenar e
 recuperar ou analisar dados. Todo algoritmo de agrupamento tentará determinar algum
 agrupamento inerente ou natural nos dados, usando medidas de distância ou similaridade entre os dados.''.

Um exemplo bem simples de agrupamento seria o ato de separar poucas frutas de aparência boa das de
 aparência não tão boa dado uma medida de aparência.
 Para esse exemplo, um ser humano conseguiria executar a tarefa de forma
competitiva com um algoritmo executado por um computador, mas quando incluímos um grande de dados de entrada
e desejamos que sejam levadas em consideração outras medidas ou outras
restrições (ex. dividir as mesmas frutas em 10 grupos, sendo 5 de frutas de melhor aparência e 5 de piores, alem de que os objetos
de cada grupo devem ser de cores e tamanhos semelhantes), os algoritmos de agrupamento podem chegar a uma solução muito melhor em menor tempo.

Dentre as aplicações práticas podemos destacar o uso de agrupamentos para data
mining, processamento de imagens, procura por padrões, redução de cores de imagens, localização de facilidades, reconhecimento de
padrões, alocação de tarefas a máquinas, definição de áreas de coleta de lixo entre muitas outras aplicações.

Os problemas de particionamento podem ser organizados segundo a taxonomia
mostrada por \cite{jain1999data} reproduzida na figura \ref{clusterTaxonomy}.
\begin{figure}
 \begin{center}
\begin{tikzpicture}[mindmap, scale=0.9]
\begin{scope}[mindmap, concept color=orange, text=white]
\node [concept] {Agrupamentos} [clockwise from=-45]
  child{node [concept]{Hierárquico} [clockwise from=0]
    child{node [concept]{Link Simples}}
    child{node [concept]{Link Completo}}
  }
  child{node [concept]{Particionado}
    child{node [concept]{Erro dos Quadrados}[clockwise from=-45]
          child{node [concept]{K-Means}}
    }
    child{node [concept]{Grafo teórico}}
    child{node [concept]{Solução de Mistura} [clockwise from=-135]
        child{node [concept]{Expectativa de Maximização}}
    }
    child{node [concept]{Método de Busca}}
  }
;
\end{scope}
\end{tikzpicture}
\caption[Taxonomia dos problemas de agrupamento]
   {\label{clusterTaxonomy}Taxonomia para os problemas de agrupamento}
\end{center}
\end{figure}

O problema de agrupamento capacitado está na classe de problemas de particionamento, mais exatamente na classe \emph{k-Means}.

Os problemas de particionamento, que serão estudados nesse trabalho, são
problemas onde é desejado descobrir partições nos conjuntos de dados de modo que
cada partição contenha apenas elementos similares entre si.

A escala de dificuldade de resolver do problema de particionamento, pode ser vista pela expressão de distintas partições $p$ existente em $n$ pontos,$N(n,p)$,
definida por \cite{liu1968cl}:
\begin{equation}
 N(p,n) = \frac{1}{p!}\sum_{i=0}^{p}(-1)^{p-1}\binom{p}{i}i^{n}
\end{equation}

Ahmadi e Osman apresentam em \cite{ahmadi2004density} um exemplo do resultado da
computação dessa expressão para uma instância com 50 pontos, o resultado pode
ser visto na imagem \ref{ahmadiCalc}.
\begin{figure}
 \begin{center}
 \includegraphics[scale=0.3]{./images/Ahmadi_Values_N_n_p.png}
 % Ahmadi_Values_N_n_p.png: 880x606 pixel, 96dpi, 23.28x16.03 cm, bb=0 0 660 454
\end{center}
\caption[Valores para N(n,p)]{\label{ahmadiCalc}Valores para N(n, p). No topo p
= 1 e na base p = 50.}
\end{figure}

Pode ser observado que mesmo para instâncias não tão grandes, o espaço
de busca é gigante. Quando consideramos instâncias maiores, como as resolvidas
por Taillard \cite{taillard2003heuristic}, onde são tratados 2863
pontos, o espaço de busca cresce ainda mais. O uso de métodos exatos é
proibitivo pelo tempo computacional que seria necessário para essas instâncias
maiores, e sendo esses problema da classe NP-Completo \cite{garey1979computers}
não existe um algoritmo que resolva de forma exata em tempo polinomial, assim o que
resta é o uso de métodos heurísticos e híbridos.
Outro fato sobre esses dados é que a ocorrência de mais agrupamentos possíveis,
ocorra com $p=16$, o que vem a mostrar que o problema é assimétrico em relação
a p.

Os problemas de agrupamentos por particionamento estão, do ponto de vista de
complexidade, entre os problemas combinatoriais mais difíceis de serem
resolvidos \cite{ahmadi2004density}

Quando temos um conjunto de pontos no espaço ($\Re^{2}$ por exemplo) e
desejamos agrupar os pontos pela sua  localização, podemos utilizar como
medida de dispersão dos grupos a distância euclidiana dos pontos em relação ao centroide
calculado pelos pontos do agrupamento. Esse é também conhecido como Problema das
K-Médias (K-Means) apresentado por \cite{macqueen1966some}

O problema das P-Medianas é uma variação do problema das K-Médias, com a diferença de utilizar uma mediana (um dos indivíduos) como referência para medição das similaridades dos pontos de cada um dos agrupamentos.

Acrescentando a restrição de capacidade aos agrupamentos, temos o problemas das P-Medianas Capacitado ou também tratado na literatura por CCP.

\section{CCP - Problema de Agrupamento Capacitado}
Como já apresentado anteriormente, o CCP tem por objectivo agrupar indivíduos de modo a maximizar as similaridades, nesse caso a proximidade, entre entre todos indivíduos de um agrupamento e a mediana do próprio agrupamento. Para o caso dos indivíduos serem representados por pontos no $\Re^{2}$, temos como similaridade o posicionamento dos mesmos no plano, a qual é medida pela distância entre eles. Na Fig. \ref{fig:Exemplo-CCP} é apresentado um exemplo de uma possível solução do CCP dado um conjunto de pontos.

\begin{figure}
\begin{centering}
\includegraphics[scale=0.5]{../TCC-I/imagens/cluster_Density_SJC4a.png}
\par\end{centering}
\caption{\label{fig:Exemplo-CCP}Exemplo de uma solução do CCP}
\end{figure}

O problema de agrupamento capacitado pode ser visto como: dado um conjunto
$I$ de $n$ indivíduos com suas respectivas demandas $d_{i}\: i\in I$,
é desejado agrupar os $n$ pontos em $p$ agrupamentos, onde a soma
das demandas em cada agrupamento deve ser menor que a capacidade total
do agrupamento, $Q_{j},\:\forall j\in P$, sendo $P$ o conjunto de
agrupamentos, e é desejado minimizar as dissimilaridades entre uma mediana do
agrupamento, para isso possuímos uma matriz $c_{IxI}$ com as distâncias entre todos os pontos. O problema pode ser representado pela seguinte formulação matemática \cite{ahmadi2004density}:

\begin{equation}
Min\;\sum_{i\in P}\sum_{j\in I}c_{ij}x_{ij}\label{eq:obj_CCP}\end{equation}
Sujeito à:
\begin{equation}
\sum_{j\in p}x_{ij}=1,\;\forall i\in I\label{eq:1Cluster_CCP}\end{equation}
\begin{equation}
\sum_{j\in P}y_{j}=p\label{eq:numClusters_CCP}\end{equation}
\begin{equation}
x_{ij}\leq y_{j,\;}\forall i\in I,\:\forall j\in P\label{eq:mustAssign_CCP}\end{equation}
\begin{equation}
\sum_{i\in I}q_{i}x_{ij}\leq Q_{j},\;\forall j\in P\label{eq:capacity_CCP}\end{equation}
\begin{equation}
x_{ij},\: y_{j}\in\{0,1\},\;\forall i\in I,\;\forall j\in P\label{eq:sets_CCP}\end{equation}

Em (\ref{eq:obj_CCP}), temos a função objetivo que minimiza a distância
entre os componentes de cada agrupamento com a mediana do agrupamento. A medida $c_{ij}$, do ponto $i$ até o ponto $j$ (mediana do agrupamento), somente é considerada
se o ponto $i$ está associado ao agrupamento $j$ pela variável binária $x_{ij}$, sendo $x_{ij}=1$ caso o ponto $i$ esteja associado ao agrupamento $j$ e $0$ caso contrário. A restrição (\ref{eq:1Cluster_CCP}) indica que cada ponto deve estar associado a um agrupamento. Já (\ref{eq:numClusters_CCP}) indica que devem existir $p$ agrupamentos. Os indivíduos somente devem ser associados a agrupamentos existentes (\ref{eq:mustAssign_CCP}), sendo $y_{j}$ o conjunto de pontos escolhidos como medianas, sendo $y_{j}$ igual a 1 se $j$ for uma mediana e 0 caso contrário. Para garantir que a capacidade $Q_{j}$ de um agrupamento $j$ não será ultrapassado, é colocada a restrição (\ref{eq:capacity_CCP}). A última restrição, (\ref{eq:sets_CCP}), especifica as variáveis inteiras de decisão.

Quando temos o valor de capacidade dos agrupamentos homogêneo, ou
seja, o valor de $Q_{j}=Q_{i}\:,\forall j\: e\:\forall i\in P$, podemos
dizer que esse é um problema das $p-medianas$ capacitado.

Um problema semelhante ao CCP foi proposto por Negreiros e Palhano em \cite{negreiros2006capacitated}. Ele é o CCCP \sigla{CCCP}{Problema de Agrupamento Centrado Capacitado - Capacitated Centred Clustering Problem} que consiste em agrupar os pontos levando em consideração a distância não para um dos pontos (mediana) mas para o centroide calculados com os pontos de cada agrupamento como apresentado na figura \ref{fig:CCCP}. São propostas 2 variações deste problema: uma onde o número de agrupamentos ($p$)é previamente conhecido ($p-CCCP$) e outra onde desejamos minimizar o número total de agrupamentos ($g-CCCP$). Após analisarmos esse problemas, decidimos permanecer trabalhando apenas com o problema CCP por melhor representar o PDOS.

\begin{figure}[hb]
\begin{centering}
\includegraphics{../TCC-I/imagens/CCCP}
\par\end{centering}

\caption{\label{fig:CCCP}Uma solução para CCCP \cite{negreiros2006capacitated}}
\end{figure}


\section{Métodos de resolução}
A utilização de métodos exatos ou mesmo de \emph{branch and bound}, não são eficientes para instâncias com maior número de pontos (indivíduos) \cite{osman1994capacitated}, pelo grande tempo de processamento exigido.

Para obter soluções em tempos computacionais viáveis, é necessário a utilização de heurísticas. Métodos heurísticos podem não gerar uma solução ótima, ou mesmo próxima dela, mas conseguem gerar soluções muito boas em um tempo computacional polinomial.

Podemos distinguir 2 tipos de heurísticas\cite{osman1994capacitated}:
\begin{itemize}
 \item Construtivas: Algoritmos desenvolvidos especificamente para uma determinada classe de problemas. Normalmente as soluções estão em um ótimo local ou muito próximo de um;
 \item Iterativas: A partir de uma solução inicial válida, e busca na vizinhança iterativamente por outras soluções melhores. A busca na vizinha normalmente conduz a um vale/pico, chegando a um ótimo local ao final das iterações.
\end{itemize}
No p?oximo capitulo apresentamos as heurísticas escolhidas para essetrabalho (uma construtiva e 4 iterativas) e sobre a busca local utilizada para melhorar as soluções geradas por as heurísticas.